
var Random = { uniform : @pythonlink "random.uniform" };

var Math = { pi : @pythonlink "math.pi",
             fabs : @pythonlink "math.fabs",
             sqrt : @pythonlink "math.sqrt",
             atan2 : @pythonlink "math.atan2" };

model "vtol_uav";

roleset ( { name : "leader" },
          { name : "follower" } );

agentset ( { name : "one", role : "leader" },
           { spawn : 10, role : "follower" } );

behaviour main {
  with roles("leader") {
    this.vx = 0;
    this.vy = 0;
    this.z = 2;
    while (1) {
      wait(1);
      this.wz = 0;
    }
  }
  |
  with roles("follower") {
    this.x = Random.uniform(0, 100);
    this.y = Random.uniform(0, 100);
    this.z = 2;
    var leader = role("leader");
    while (1) {
      var dx = leader.x - this.x;
      var dy = leader.y - this.y;
      var hdg_difference = Math.atan2(dy, dx)  - this.yaw;
      #this.wz = hdg_difference * 180.0/3.14159 * 20;
      this.wz = 0;#hdg_difference * 0.05;
      wait(0.1);
    }
  }
}

